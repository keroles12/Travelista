@using Microsoft.AspNetCore.Identity
@inject UserManager<IdentityUser> UserManager
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title>@ViewBag.Title - My ASP.NET Application</title>
     <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
     <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
     <link rel="stylesheet" href="~/Travelista.styles.css" asp-append-version="true" />
     <link  rel="stylesheet" href="~/css/Register.css"/>
      <link  rel="stylesheet" href="~/css/StyleSheet.css"/>
       <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@48,400,1,0" />
  
     
  
    
    
  

</head>
<body>
    <nav class="navbar navbar-expand-sm navbar-toggleable-sm navbar-dark p-3" style="background-color: #00357D">
        <div class="container">
            @Html.ActionLink("Travelista", "Index", "Home", new { area = "" }, new { @class = "navbar-brand h1 fw-bold fs-4" })
            <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target=".navbar-collapse" title="Toggle navigation" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
                        <a asp-action="Index" asp-controller="Home" class="h5  mt-1 text-decoration-none text-light  " >
                        Home
                     </a>
            
              @if(User.IsInRole("admin"))
                 
                {
                    <div class="dropdown">
                      <a class="h5 ms-3 text-decoration-none text-light  dropdown-toggle"  id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                    Admin
                     </a>
                      <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
                        <li><a class="dropdown-item" asp-action="Index" asp-controller="Countries">Country</a></li>
                        <li><a class="dropdown-item"  asp-action="Index" asp-controller="Cities">City</a></li>
                        <li><a class="dropdown-item"  asp-action="Index" asp-controller="Hotels">Hotel</a></li>
                        <li><a class="dropdown-item"  asp-action="Index" asp-controller="Rooms">Room</a></li>
                        <li><a class="dropdown-item"  asp-action="Index" asp-controller="Images">Image</a></li>
                        <li><a class="dropdown-item"  asp-action="Index" asp-controller="Bookings">Booking</a></li>
                        <li><a class="dropdown-item"  asp-action="Index" asp-controller="Recommendations">Recommendations</a></li>

                    </ul>
                   </div>
            }
              
         
            <div class="collapse navbar-collapse d-sm-inline-flex justify-content-between">
                <ul class="navbar-nav flex-grow-1 justify-content-end align-items-center">

                  @*  <li class="text-white"><a class="text-white text-decoration-none" href="#">EGP</a></li>
                    <li class="text-white mx-4"><a href="#"><img style="width:25px; height:25px; border-radius:50%" src="https://t-cf.bstatic.com/design-assets/assets/v3.72.0/images-flags/Us@3x.png" /></a></li>
                    <li class="text-white">Service</li>*@
                    <partial name="_LoginPartial" />
                </ul>
                
            </div>
        </div>
    </nav>
    <div>
        @RenderBody()
    </div>
    <div class="">
        <hr />
        <footer class="">
            <div class="py-3" style="background: #00224F;">
                <div class="container text-center text-white p-5 fw-light">
                    <h3 class="fw-light">Save time, save money!</h3>
                    <p>Sign up and we'll send the best deals to you</p>
                    <form class="form-inline d-flex justify-content-center">
                        <div class="form-group mx-sm-3 mb-2">
                            <input type="password" class="form-control py-2 px-5" placeholder="Your email address">
                        </div>
                        <button type="submit" class="btn btn-primary mb-2 py-2 px-5">Subscribe</button>
                    </form>
                </div>
            </div>

            <div class="container">
                <div class="row justify-content-around footer-link">
                    <div class="col-2 justify-content-around">
                        <ul class="list-unstyled py-5">
                            <li class="py-1"><a href="#">Countries</a></li>
                            <li class="py-1"><a href="#">Regions</a></li>
                            <li class="py-1"><a href="#">Cities</a></li>
                            <li class="py-1"><a href="#">Districts</a></li>
                            <li class="py-1"><a href="#">Airports</a></li>
                            <li class="py-1"><a href="#">Hotels</a></li>
                            <li class="py-1"><a href="#">Places of interest</a></li>
                        </ul>
                    </div>
                    <div class="col-2 justify-content-around">
                        <ul class="list-unstyled py-5">
                            <li class="py-1"><a href="#">Homes</a></li>
                            <li class="py-1"><a href="#">Apartments</a></li>
                            <li class="py-1"><a href="#">Resorts</a></li>
                            <li class="py-1"><a href="#">Villas</a></li>
                            <li class="py-1"><a href="#">Hostels</a></li>
                            <li class="py-1"><a href="#">B&Bs</a></li>
                            <li class="py-1"><a href="#">Guest houses</a></li>
                        </ul>
                    </div>
                    <div class="col-2 justify-content-around">
                        <ul class="list-unstyled py-5">
                            <li class="py-1"><a href="#">Unique places to stay</a></li>
                            <li class="py-1"><a href="#">Reviews</a></li>
                            <li class="py-1"><a href="#">Discover monthly stays</a></li>
                            <li class="py-1"><a href="#">Unpacked: Travel articles</a></li>
                            <li class="py-1"><a href="#">Seasonal and holiday deals</a></li>
                            <li class="py-1"><a href="#">Traveller Review Awards</a></li>
                        </ul>
                    </div>
                    <div class="col-2 justify-content-around">
                        <ul class="list-unstyled py-5">
                            <li class="py-1"><a href="#">Car hire</a></li>
                            <li class="py-1"><a href="#">Flight finder</a></li>
                            <li class="py-1"><a href="#">Restaurant reservations</a></li>
                            <li class="py-1"><a href="#">Booking.com for Travel Agents</a></li>
                        </ul>
                    </div>
                    <div class="col-2 justify-content-around">
                        <ul class="list-unstyled py-5">
                            <li class="py-1"><a href="#">Coronavirus (COVID-19) FAQ</a></li>
                            <li class="py-1"><a href="#">About Booking.com</a></li>
                            <li class="py-1"><a href="#">Customer Service help</a></li>
                            <li class="py-1"><a href="#">Partner help</a></li>
                            <li class="py-1"><a href="#">Careers</a></li>
                            <li class="py-1"><a href="#">Sustainability</a></li>
                            <li class="py-1"><a href="#">Press centre</a></li>
                            <li class="py-1"><a href="#">Safety resource centre</a></li>
                            <li class="py-1"><a href="#">Investor relations</a></li>
                            <li class="py-1"><a href="#">Terms & Conditions</a></li>
                            <li class="py-1"><a href="#">Partner dispute</a></li>
                            <li class="py-1"><a href="#">How we work</a></li>
                            <li class="py-1"><a href="#">Privacy & Cookie Statement</a></li>
                            <li class="py-1"><a href="#">MSA Statement</a></li>
                            <li class="py-1"><a href="#">Corporate contact</a></li>
                            <li class="py-1"><a href="#">Content guidelines</a></li>
                            <li class="py-1"><a href="#">We Price Match</a></li>
                        </ul>
                    </div>
                </div>
                <div class="text-center">
                    <a class="text-decoration-none" href="#">Extranet login</a>
                    <p class="text-start py-5">Copyright © 1996–2023 Booking.com™. All rights reserved.</p>
                    <p class="text-center text-secondary">Booking.com is part of Booking Holdings Inc., the world leader in online travel and related services.</p>
                </div>
                <div class="pt-5">
                    <ul class="list-unstyled d-flex justify-content-evenly">
                        <li><img src="https://cf.bstatic.com/static/img/tfl/group_logos/logo_booking/27c8d1832de6a3123b6ee45b59ae2f81b0d9d0d0.png" alt=""></li>
                        <li><img src="https://cf.bstatic.com/static/img/tfl/group_logos/logo_priceline/f80e129541f2a952d470df2447373390f3dd4e44.png" alt=""></li>
                        <li><img src="https://cf.bstatic.com/static/img/tfl/group_logos/logo_kayak/83ef7122074473a6566094e957ff834badb58ce6.png" alt=""></li>
                        <li><img src="https://cf.bstatic.com/static/img/tfl/group_logos/logo_agoda/1c9191b6a3651bf030e41e99a153b64f449845ed.png" alt=""></li>
                        <li><img src="https://cf.bstatic.com/static/img/tfl/group_logos/logo_rentalcars/6bc5ec89d870111592a378bbe7a2086f0b01abc4.png" alt=""></li>
                        <li><img src="https://cf.bstatic.com/static/img/tfl/group_logos/logo_opentable/a4b50503eda6c15773d6e61c238230eb42fb050d.png" alt=""></li>
                    </ul>
                    <p class="text-center pt-3">JWG2023</p>
                </div>

            </div>
        </footer>
    </div>
    <button class="chatbot-toggler">
      <span class="material-symbols-rounded">mode_comment</span>
      <span class="material-symbols-outlined">close</span>
    </button>
    <div class="chatbot">
      <header>
        <h2>Chat</h2>
        <span class="close-btn material-symbols-outlined">close</span>
      </header>
      <ul class="chatbox">
        <li class="chat incoming">
          <span class="material-symbols-outlined">smart_toy</span>
          <p>Hi there 👋<br>choose any number</p>
        </li>
        <li class="chat incoming">
          <span class="material-symbols-outlined">smart_toy</span>
          <p>1- Is there an airport transfer service available?</p>
        </li>
        <li class="chat incoming">
          <span class="material-symbols-outlined">smart_toy</span>
          <p>2- What is the cancellation policy? Is it possible to cancel the booking without any fees?</p>
        </li>
        <li class="chat incoming">
          <span class="material-symbols-outlined">smart_toy</span>
          <p>3- Are there any facilities for children such as a playground or kids club?</p>
        </li>
        <li class="chat incoming">
          <span class="material-symbols-outlined">smart_toy</span>
          <p>4- Does the hotel provide free Wi-Fi service?</p>
        </li>
        <li class="chat incoming">
          <span class="material-symbols-outlined">smart_toy</span>
          <p>5- Does the cost of accommodation include breakfast or any other meals?</p>
        </li>
        
      </ul>
      <ul>

                    <li><p>Hi there 👋<br>choise any number</p></li>
                    <li><p> 1- Is there an airport transfer service available?</p></li>
                    <li><p> 2- What is the cancellation policy? Is it possible to cancel the booking without any fees?</p></li>
                    <li><p> 3- Are there any facilities for children such as a playground or kids club?</p></li>
                    <li><p> 4- Does the hotel provide free Wi-Fi service?</p></li>
                    <li><p> 5- Does the cost of accommodation include breakfast or any other meals?</p></li>
                    
          </ul>
      <div class="chat-input">
        <textarea placeholder="Enter a message..." spellcheck="false" required></textarea>
        <span id="send-btn" class="material-symbols-rounded">send</span>
      </div>
    </div>
   @* @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")
    @RenderSection("scripts", required: false)*@
     <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    @await RenderSectionAsync("Scripts", required: false)
    <script src="~/js/Script.js"></script>
    <script>

const chatbotToggler = document.querySelector(".chatbot-toggler");
const closeBtn = document.querySelector(".close-btn");
const chatbox = document.querySelector(".chatbox");
const chatInput = document.querySelector(".chat-input textarea");
const sendChatBtn = document.querySelector(".chat-input span");

let userMessage = null; // Variable to store user's message
const API_KEY = "PASTE-YOUR-API-KEY"; // Paste your API key here
const inputInitHeight = chatInput.scrollHeight;

const createChatLi = (message, className) => {
    // Create a chat <li> element with passed message and className
    const chatLi = document.createElement("li");
    chatLi.classList.add("chat", `${className}`);
    let chatContent = className === "outgoing" ? `<p></p>` : `<span class="material-symbols-outlined">smart_toy</span><p></p>`;
    chatLi.innerHTML = chatContent;
    chatLi.querySelector("p").textContent = message;
    return chatLi; // return chat <li> element
}

// Send POST request to API, get response and set the reponse as paragraph text
 const generateResponse = (chatElement) => {
        const messageElement = chatElement.querySelector("p");
    
        // Read responses from JSON file
        fetch("/Data.json").then(res => res.json()).then(data => {
            // Choose a random response from the list and set it as paragraph text
            const responses = data.responses;
          //  messageElement.textContent = response.trim();
                if (userMessage == "1") {
                    const response = responses[0];
                    messageElement.textContent = response.trim();
                }
                else if(userMessage == "2"){
                    const response = responses[1];
                    messageElement.textContent = response.trim();
                }
                else if (userMessage == "3") {
                    const response = responses[2];
                    messageElement.textContent = response.trim();
                }
                else if (userMessage == "4") {
                    const response = responses[3];
                    messageElement.textContent = response.trim();
                }
                else if (userMessage == "5") {
                    const response = responses[4];
                    messageElement.textContent = response.trim();
                } 
                else {
                    const response = responses[5];
                    messageElement.textContent = response.trim();
                }
        }).catch(() => {
            messageElement.classList.add("error");
            messageElement.textContent = "Oops! Something went wrong. Please try again.";
        }).finally(() => chatbox.scrollTo(0, chatbox.scrollHeight));
    }
const handleChat = () => {
    userMessage = chatInput.value.trim(); // Get user entered message and remove extra whitespace
    if(!userMessage) return;

    // Clear the input textarea and set its height to default
    chatInput.value = "";
    chatInput.style.height = `${inputInitHeight}px`;

    // Append the user's message to the chatbox
    chatbox.appendChild(createChatLi(userMessage, "outgoing"));
    chatbox.scrollTo(0, chatbox.scrollHeight);
    
    setTimeout(() => {
        // Display "Thinking..." message while waiting for the response
        const incomingChatLi = createChatLi("Thinking...", "incoming");
        chatbox.appendChild(incomingChatLi);
        chatbox.scrollTo(0, chatbox.scrollHeight);
        generateResponse(incomingChatLi);
    }, 600);
}

chatInput.addEventListener("input", () => {
    // Adjust the height of the input textarea based on its content
    chatInput.style.height = `${inputInitHeight}px`;
    chatInput.style.height = `${chatInput.scrollHeight}px`;
});

chatInput.addEventListener("keydown", (e) => {
    // If Enter key is pressed without Shift key and the window 
    // width is greater than 800px, handle the chat
    if(e.key === "Enter" && !e.shiftKey && window.innerWidth > 800) {
        e.preventDefault();
        handleChat();
    }
});

sendChatBtn.addEventListener("click", handleChat);
closeBtn.addEventListener("click", () => document.body.classList.remove("show-chatbot"));
chatbotToggler.addEventListener("click", () => document.body.classList.toggle("show-chatbot"));
    </script>
    
</body>
</html>
